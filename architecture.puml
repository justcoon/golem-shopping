@startuml Golem Shopping Architecture

' Define styles
skinparam componentStyle uml2
skinparam backgroundColor #F5F5F5
skinparam defaultFontName Arial
skinparam defaultFontSize 12
skinparam roundcorner 10
skinparam shadowing true
skinparam ArrowColor #666666
skinparam ComponentBackgroundColor #E8E8E8
skinparam ComponentBorderColor #666666

' Define components
actor "User" as user #FFD700

package "Golem Cloud" {
    [API Gateway] as gateway #F9E79F
    [Product Worker] as product #D5F5E3
    [Pricing Worker] as pricing #D6EAF8
    [Cart Worker] as cart #FADBD8
    [Order Worker] as order #E8DAEF
    [Product Search Worker] as product_search #D1F2EB
}

' Define relationships
user --> gateway : "HTTP Requests\n(REST API Calls)"

gateway --> product : "RPC\nProduct API"
gateway --> pricing : "RPC\nPricing API"
gateway --> cart : "RPC\nCart API"
gateway --> order : "RPC\nOrder API"
gateway --> product_search : "RPC\nProduct Search API"

' Worker-to-worker communication
cart --> product : "RPC\nGet product info"
cart --> pricing : "RPC\nGet pricing info"
cart --> order : "RPC\nCreate order from cart"
order --> product : "RPC\nGet product info"
order --> pricing : "RPC\nGet pricing info"
product_search --> product : "RPC\nGet product info"

' Add notes
note right of gateway
  <b>API Gateway</b>
  - Routes REST API to workers
  • /v1/products/** → Product Worker
  • /v1/pricing/** → Pricing Worker
  • /v1/cart/** → Cart Worker
  • /v1/orders/** → Order Worker
  • /v1/product/search → Product Search Worker
  - Transforms REST to Golem RPC
end note

note right of product
  <b>Product Worker</b>
  - Manages product catalog
  - State managed by Golem Cloud
end note

note right of pricing
  <b>Pricing Worker</b>
  - Manages product pricing
  - Handles discounts/promotions
  - State managed by Golem Cloud
end note

note right of cart
  <b>Cart Worker</b>
  - Manages user shopping carts
  - One cart per user
  - Converts to order on checkout
  - State managed by Golem Cloud
end note

note right of order
  <b>Order Worker</b>
  - Manages order lifecycle
  - Handles order processing
  - State management (New/Shipped/Cancelled)
  - State managed by Golem Cloud
end note

note right of product_search
  <b>Product Search Worker</b>
  - Worker per request
  - Gets product info from Product Workers
  - No persistent state
end note

@enduml
